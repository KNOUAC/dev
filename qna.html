<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì—…ë°ì´íŠ¸ëœ ë¬¸ì œ JSON ìƒì„±ê¸°</title>
    <style>
        body { font-family: 'Malgun Gothic', sans-serif; line-height: 1.6; padding: 20px; background: #f0f2f5; }
        .container { max-width: 900px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); }
        h2 { border-bottom: 2px solid #007bff; padding-bottom: 10px; color: #333; }
        .section-title { font-weight: bold; color: #007bff; margin-top: 20px; margin-bottom: 10px; display: block; border-left: 4px solid #007bff; padding-left: 10px; }
        
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .form-group { margin-bottom: 15px; }
        .full-width { grid-column: span 2; }
        
        label { display: block; font-weight: bold; margin-bottom: 5px; font-size: 0.9em; }
        input[type="text"], input[type="number"], textarea, select { 
            width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; 
        }
        textarea { height: 120px; font-family: 'Consolas', monospace; font-size: 0.9em; }
        
        .options-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; background: #f9f9f9; padding: 15px; border-radius: 6px; }
        
        .btn-group { margin-top: 30px; display: flex; gap: 10px; justify-content: center; }
        button { padding: 12px 25px; cursor: pointer; border: none; border-radius: 6px; font-weight: bold; transition: 0.2s; }
        .btn-save { background: #28a745; color: white; }
        .btn-save:hover { background: #218838; }
        .btn-json { background: #007bff; color: white; }
        .btn-json:hover { background: #0069d9; }
        .btn-clear { background: #6c757d; color: white; }
        
        #json-output { 
            margin-top: 25px; background: #2d2d2d; color: #ccc; padding: 20px; 
            border-radius: 8px; white-space: pre-wrap; font-family: 'Consolas', monospace; font-size: 0.85em;
            max-height: 500px; overflow-y: auto;
        }
        .item-count { font-size: 1.1em; margin-bottom: 15px; text-align: right; }
        .item-count b { color: #007bff; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ§© ë¬¸ì œ ë°ì´í„° JSON ì—ë””í„°</h2>
    <div class="item-count">í˜„ì¬ ì €ì¥ëœ ë¬¸í•­: <b id="count">0</b>ê°œ</div>

    <div class="form-grid">
        <div class="form-group">
            <label>ë¬¸í•­ ë²ˆí˜¸ (ID)</label>
            <input type="number" id="inp-id" placeholder="ì˜ˆ: 36">
        </div>
        <div class="form-group">
            <label>ì°¸ì¡° ì•ˆë‚´ë¬¸ (refInstruction)</label>
            <input type="text" id="inp-ref" placeholder="ì˜ˆ: ì•„ë˜ ë‹¤ì´ì–´ê·¸ë¨ì„ ë³´ê³ ...">
        </div>

        <div class="form-group">
            <label>ìƒë‹¨ ì´ë¯¸ì§€ ê²½ë¡œ (imgTop)</label>
            <input type="text" id="inp-imgTop" placeholder="./path/to/image.jpg">
        </div>
        <div class="form-group">
            <label>í•˜ë‹¨ ì´ë¯¸ì§€ ê²½ë¡œ (imgBottom)</label>
            <input type="text" id="inp-imgBottom" placeholder="./path/to/image.jpg">
        </div>

        <div class="form-group full-width">
            <label>ì§ˆë¬¸ (Question)</label>
            <input type="text" id="inp-q" placeholder="ì§ˆë¬¸ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.">
        </div>
        <div class="form-group full-width">
            <label>ì§€ë¬¸ (Passage) - ì½”ë“œ ë“±</label>
            <textarea id="inp-p" placeholder="ì§€ë¬¸ì´ë‚˜ ì†ŒìŠ¤ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš”."></textarea>
        </div>

        <div class="full-width">
            <span class="section-title">ë³´ê¸° ë° ì •ë‹µ ì„¤ì •</span>
            <div class="options-grid">
                <div><label>ë³´ê¸° 1</label><input type="text" class="opt" placeholder="ì˜µì…˜ 0"></div>
                <div><label>ë³´ê¸° 2</label><input type="text" class="opt" placeholder="ì˜µì…˜ 1"></div>
                <div><label>ë³´ê¸° 3</label><input type="text" class="opt" placeholder="ì˜µì…˜ 2"></div>
                <div><label>ë³´ê¸° 4</label><input type="text" class="opt" placeholder="ì˜µì…˜ 3"></div>
                <div style="margin-top: 10px;">
                    <label>ì •ë‹µ ì„ íƒ</label>
                    <select id="inp-ans">
                        <option value="0">ë³´ê¸° 1ë²ˆ</option>
                        <option value="1">ë³´ê¸° 2ë²ˆ</option>
                        <option value="2">ë³´ê¸° 3ë²ˆ</option>
                        <option value="3">ë³´ê¸° 4ë²ˆ</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="form-group full-width">
            <span class="section-title">í•´ì„¤ ì„¤ì •</span>
            <label>í•´ì„¤ ì´ë¯¸ì§€ ê²½ë¡œ (explanationImg)</label>
            <input type="text" id="inp-expImg" placeholder="./path/to/explanation.jpg" style="margin-bottom: 10px;">
            <label>í•´ì„¤ í…ìŠ¤íŠ¸ (explanation)</label>
            <textarea id="inp-exp" style="height: 80px;"></textarea>
        </div>
    </div>

    <div class="btn-group">
        <button class="btn-save" onclick="addItem()">ë¬¸í•­ ì¶”ê°€</button>
        <button class="btn-json" onclick="exportJSON()">JSON ì½”ë“œ ë³µì‚¬</button>
        <button class="btn-clear" onclick="resetForm()">ì…ë ¥ì°½ ì´ˆê¸°í™”</button>
    </div>

    <div id="json-output">// ì €ì¥ëœ ë¬¸í•­ì´ ì—†ìŠµë‹ˆë‹¤.</div>
</div>

<script>
    let db = [];

    function addItem() {
        const idVal = document.getElementById('inp-id').value;
        const qVal = document.getElementById('inp-q').value;
        if(!idVal || !qVal) { alert("IDì™€ ì§ˆë¬¸ì€ í•„ìˆ˜ì…ë‹ˆë‹¤."); return; }

        // ê°ì²´ ìƒì„± (ë°ì´í„°ê°€ ìˆëŠ” ê²½ìš°ì—ë§Œ í•„ë“œ ì¶”ê°€)
        const item = {
            id: parseInt(idVal),
            refInstruction: document.getElementById('inp-ref').value || undefined,
            imgTop: document.getElementById('inp-imgTop').value || undefined,
            imgBottom: document.getElementById('inp-imgBottom').value || undefined,
            passage: document.getElementById('inp-p').value || "",
            question: qVal,
            options: Array.from(document.querySelectorAll('.opt')).map(i => i.value),
            answer: parseInt(document.getElementById('inp-ans').value),
            explanationImg: document.getElementById('inp-expImg').value || undefined,
            explanation: document.getElementById('inp-exp').value || ""
        };

        // undefined í•„ë“œ ì œê±°í•˜ì—¬ ê¹”ë”í•œ JSON ìœ ì§€
        Object.keys(item).forEach(key => item[key] === undefined && delete item[key]);

        db.push(item);
        updateDisplay();
        document.getElementById('inp-id').value = parseInt(idVal) + 1; // ë‹¤ìŒ ë²ˆí˜¸ ìë™ ì„¸íŒ…
        alert(idVal + "ë²ˆ ë¬¸í•­ì´ ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.");
    }

    function updateDisplay() {
        document.getElementById('count').innerText = db.length;
        document.getElementById('json-output').innerText = JSON.stringify(db, null, 4);
    }

    function exportJSON() {
        const text = JSON.stringify(db, null, 4);
        navigator.clipboard.writeText(text).then(() => {
            alert("JSON ì½”ë“œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
        });
    }

    function resetForm() {
        const ids = ['inp-ref', 'inp-imgTop', 'inp-imgBottom', 'inp-p', 'inp-q', 'inp-expImg', 'inp-exp'];
        ids.forEach(id => document.getElementById(id).value = '');
        document.querySelectorAll('.opt').forEach(opt => opt.value = '');
    }
</script>

</body>
</html>
