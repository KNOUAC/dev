<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>채점 효과 퀴즈</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <style>
        body { font-family: "Pretendard Variable", Pretendard, -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif; }
        
        /* 쾅! 찍히는 애니메이션 */
        @keyframes stamp-pop {
            0% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
            50% { transform: translate(-50%, -50%) scale(0.9); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
        }

        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* 채점 마크 공통 스타일 */
        .grading-mark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 120%;  /* 버튼보다 조금 더 크게 */
            height: 120%;
            pointer-events: none; /* 마우스 클릭 통과 */
            z-index: 20;
            animation: stamp-pop 0.3s cubic-bezier(0.5, 0, 0.5, 1.5) forwards;
            opacity: 0.9;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div class="max-w-2xl w-full bg-white rounded-3xl shadow-xl overflow-hidden border border-gray-200">
        
        <div class="bg-white p-6 border-b border-gray-100">
            <div class="flex justify-between items-center mb-4">
                <span class="px-3 py-1 bg-blue-50 text-blue-600 text-xs font-bold rounded-full">모의고사</span>
                <div class="text-sm text-gray-500 font-medium">
                    <span id="current-num" class="text-blue-600 font-bold">1</span> / <span id="total-num">0</span>
                </div>
            </div>
            <div class="w-full bg-gray-100 rounded-full h-2">
                <div id="progress-bar" class="bg-blue-500 h-2 rounded-full transition-all duration-500" style="width: 0%"></div>
            </div>
        </div>

        <div class="p-6 sm:p-8 relative">
            <div class="mb-8">
                <span class="inline-block bg-slate-700 text-white text-xs px-2 py-1 rounded mb-2">Q<span id="q-id">1</span></span>
                <h2 id="question-text" class="text-xl sm:text-2xl font-bold text-slate-800 leading-snug">
                    로딩 중...
                </h2>
            </div>

            <div id="options-container" class="space-y-4"></div>

            <div id="result-area" class="mt-8 hidden fade-in">
                <div id="result-box" class="p-5 rounded-xl border mb-4 bg-gray-50">
                    <h3 id="result-title" class="font-bold text-lg mb-2"></h3>
                    <p id="explanation-text" class="text-gray-700 text-sm leading-relaxed"></p>
                </div>
            </div>
        </div>

        <div class="p-6 bg-gray-50 border-t border-gray-100 flex justify-between">
            <button onclick="prevQuestion()" class="px-4 py-2 text-gray-500 hover:text-gray-900 font-medium transition">이전</button>
            <button onclick="nextQuestion()" class="px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-md transition">다음</button>
        </div>
    </div>

    <script>
        // --- 손으로 그린 듯한 SVG 아이콘 데이터 ---
        // 붉은 동그라미 (정답)
        const svgCircle = `
            <svg viewBox="0 0 200 200" class="grading-mark" style="stroke: #ef4444; fill: none; stroke-width: 8; stroke-linecap: round; stroke-linejoin: round;">
                <path d="M40,160 Q20,100 50,40 Q100,10 160,40 Q190,100 150,160 Q100,190 40,160 M35,155 Q20,110 45,165" />
            </svg>
        `;
        
        // 붉은 빗금 (오답 - 영상처럼 작대기 긋는 느낌)
        const svgSlash = `
            <svg viewBox="0 0 200 200" class="grading-mark" style="stroke: #ef4444; fill: none; stroke-width: 8; stroke-linecap: round;">
                <path d="M40,170 Q100,100 170,30" />
                <path d="M50,180 Q110,110 160,40" style="opacity:0.5; stroke-width:4;" /> 
            </svg>
        `;

        let questions = [];
        let currentIdx = 0;
        let isAnswered = false;

        fetch('questions.json')
            .then(res => res.ok ? res.json() : [])
            .then(data => { questions = data; loadQuestion(); })
            .catch(err => document.getElementById('question-text').innerText = "오류 발생");

        function loadQuestion() {
            if (questions.length === 0) return;
            isAnswered = false;
            const q = questions[currentIdx];
            
            document.getElementById('q-id').innerText = currentIdx + 1;
            document.getElementById('question-text').innerText = q.question;
            document.getElementById('current-num').innerText = currentIdx + 1;
            document.getElementById('total-num').innerText = questions.length;
            document.getElementById('progress-bar').style.width = `${((currentIdx + 1) / questions.length) * 100}%`;
            document.getElementById('result-area').classList.add('hidden');

            const container = document.getElementById('options-container');
            container.innerHTML = '';

            q.options.forEach((opt, idx) => {
                const btn = document.createElement('button');
                // 버튼 내부는 relative여야 마크가 그 안에 갇힘
                btn.className = "relative w-full text-left p-5 rounded-xl border-2 border-gray-100 hover:border-gray-300 hover:bg-gray-50 transition-all duration-200 text-gray-700 font-medium text-lg";
                btn.innerHTML = `<span class="inline-block mr-3 text-gray-400 font-bold">${String.fromCharCode(65 + idx)}.</span> ${opt}`;
                
                btn.onclick = () => checkAnswer(idx, btn);
                container.appendChild(btn);
            });
        }

        function checkAnswer(selectedIdx, btnElement) {
            if (isAnswered) return;
            isAnswered = true;

            const q = questions[currentIdx];
            const isCorrect = selectedIdx === q.answer;
            const resultArea = document.getElementById('result-area');
            const resultBox = document.getElementById('result-box');
            const resultTitle = document.getElementById('result-title');

            // --- 여기가 핵심: SVG 삽입 ---
            // 영상 느낌을 위해 정답/오답 모두 '빨간펜' 색상(#ef4444)으로 통일했습니다.
            // 초록색을 원하시면 svg 변수 안의 stroke 색을 바꾸면 됩니다.
            
            if (isCorrect) {
                // 정답: 동그라미 SVG 추가
                btnElement.innerHTML += svgCircle;
                btnElement.classList.add('border-red-400', 'bg-red-50'); // 테두리도 빨갛게
                
                resultTitle.innerHTML = "정답입니다!";
                resultBox.className = "p-5 rounded-xl border border-green-200 bg-green-50 text-green-800";
            } else {
                // 오답: 빗금 SVG 추가
                btnElement.innerHTML += svgSlash;
                btnElement.classList.add('border-gray-300'); 
                
                // 정답지 버튼에도 동그라미 표시해주기 (친절한 UI)
                const correctBtn = document.getElementById('options-container').children[q.answer];
                correctBtn.innerHTML += svgCircle;
                correctBtn.classList.add('border-red-400', 'bg-red-50');

                resultTitle.innerHTML = "오답입니다.";
                resultBox.className = "p-5 rounded-xl border border-red-200 bg-red-50 text-red-800";
            }

            document.getElementById('explanation-text').innerText = q.explanation;
            resultArea.classList.remove('hidden');
        }

        function nextQuestion() {
            if (currentIdx < questions.length - 1) { currentIdx++; loadQuestion(); }
            else if(confirm("처음으로?")) { currentIdx = 0; loadQuestion(); }
        }

        function prevQuestion() {
            currentIdx--;
            if (currentIdx < 0) currentIdx = questions.length - 1;
            loadQuestion();
        }
    </script>
</body>
</html>