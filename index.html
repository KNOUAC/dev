<script>
        // --- 1. 데이터 변수 선언 (처음엔 비워둠) ---
        let questions = [];
        let currentIdx = 0;
        let isAnswered = false;

        // --- 2. JSON 데이터 불러오기 ---
        fetch('questions.json')
            .then(response => response.json())
            .then(data => {
                questions = data; // 가져온 데이터를 변수에 저장
                loadQuestion();   // 데이터가 준비되면 첫 문제 표시
            })
            .catch(error => {
                console.error("데이터 로딩 실패:", error);
                document.getElementById('question-text').innerText = "문제를 불러올 수 없습니다.";
            });

        // --- 3. 렌더링 함수 (기존과 동일) ---
        function loadQuestion() {
            if (questions.length === 0) return; // 데이터가 없으면 중단

            isAnswered = false;
            const q = questions[currentIdx];
            
            // 텍스트 업데이트
            document.getElementById('q-id').innerText = currentIdx + 1;
            document.getElementById('question-text').innerText = q.question;
            document.getElementById('current-num').innerText = currentIdx + 1;
            document.getElementById('total-num').innerText = questions.length;
            
            // 프로그레스 바 업데이트
            const progress = ((currentIdx + 1) / questions.length) * 100;
            document.getElementById('progress-bar').style.width = `${progress}%`;

            // 해설창 숨기기
            document.getElementById('result-area').classList.add('hidden');

            // 보기 버튼 생성
            const optsContainer = document.getElementById('options-container');
            optsContainer.innerHTML = '';

            q.options.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = `w-full text-left p-4 rounded-xl border border-gray-200 hover:border-indigo-400 hover:bg-indigo-50 transition-all duration-200 group flex items-start gap-3`;
                btn.innerHTML = `
                    <span class="flex-shrink-0 w-6 h-6 rounded-full bg-gray-100 text-gray-500 text-xs flex items-center justify-center font-bold group-hover:bg-indigo-200 group-hover:text-indigo-700 transition">${String.fromCharCode(65 + idx)}</span>
                    <span class="text-gray-700 font-medium group-hover:text-indigo-900">${opt}</span>
                `;
                btn.onclick = () => checkAnswer(idx, btn);
                optsContainer.appendChild(btn);
            });
        }

        // --- 4. 정답 확인 (기존과 동일) ---
        function checkAnswer(selectedIdx, btnElement) {
            if (isAnswered) return;
            isAnswered = true;

            const q = questions[currentIdx];
            const isCorrect = selectedIdx === q.answer;
            const resultArea = document.getElementById('result-area');
            const resultBox = document.getElementById('result-box');
            const resultTitle = document.getElementById('result-title');
            const explanationText = document.getElementById('explanation-text');

            if (isCorrect) {
                btnElement.classList.replace('border-gray-200', 'border-green-500');
                btnElement.classList.replace('hover:border-indigo-400', 'bg-green-50');
                btnElement.classList.remove('hover:bg-indigo-50');
                
                resultBox.className = "p-5 rounded-xl border border-green-200 bg-green-50 text-green-800";
                resultTitle.innerHTML = `✅ 정답입니다!`;
            } else {
                btnElement.classList.replace('border-gray-200', 'border-red-500');
                btnElement.classList.add('bg-red-50');
                
                resultBox.className = "p-5 rounded-xl border border-red-200 bg-red-50 text-red-800";
                resultTitle.innerHTML = `❌ 아쉽네요.`;
            }

            explanationText.innerText = q.explanation;
            resultArea.classList.remove('hidden');
        }

        // --- 5. 다음 문제 (기존과 동일) ---
        function nextQuestion() {
            if (currentIdx < questions.length - 1) {
                currentIdx++;
                loadQuestion();
            } else {
                if(confirm("모든 문제를 완료했습니다! 처음으로 돌아갈까요?")) {
                    currentIdx = 0;
                    loadQuestion();
                }
            }
        }

        // --- 6. 이전 문제 (기존과 동일) ---
        function prevQuestion() {
            currentIdx--;
            if (currentIdx < 0) {
                currentIdx = questions.length - 1;
            }
            loadQuestion();
        }

        // loadQuestion()은 이제 fetch() 안에서 실행되므로 여기서는 제거합니다.
    </script>